<!DOCTYPE html>
<!--[if IE]><![endif]-->
<html>
  
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>X-Road Type Providers in C# Projects </title>
    <meta name="viewport" content="width=device-width">
    <meta name="title" content="X-Road Type Providers in C# Projects ">
    <meta name="generator" content="docfx 2.40.10.0">
    
    <link rel="shortcut icon" href="../../favicon.ico">
    <link rel="stylesheet" href="../../styles/docfx.vendor.css">
    <link rel="stylesheet" href="../../styles/docfx.css">
    <link rel="stylesheet" href="../../styles/main.css">
    <meta property="docfx:navrel" content="../../toc.html">
    <meta property="docfx:tocrel" content="../toc.html">
    
    
    
  </head>
  <body data-spy="scroll" data-target="#affix" data-offset="120">
    <div id="wrapper">
      <header>
        
        <nav id="autocollapse" class="navbar navbar-inverse ng-scope" role="navigation">
          <div class="container">
            <div class="navbar-header">
              <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </button>
              
              <a class="navbar-brand" href="../../index.html">
                <img id="logo" class="svg" src="../../logo.svg" alt="">
              </a>
            </div>
            <div class="collapse navbar-collapse" id="navbar">
              <form class="navbar-form navbar-right" role="search" id="search">
                <div class="form-group">
                  <input type="text" class="form-control" id="search-query" placeholder="Search" autocomplete="off">
                </div>
              </form>
            </div>
          </div>
        </nav>
        
        <div class="subnav navbar navbar-default">
          <div class="container hide-when-search" id="breadcrumb">
            <ul class="breadcrumb">
              <li></li>
            </ul>
          </div>
        </div>
      </header>
      <div role="main" class="container body-content hide-when-search">
        
        <div class="sidenav hide-when-search">
          <a class="btn toc-toggle collapse" data-toggle="collapse" href="#sidetoggle" aria-expanded="false" aria-controls="sidetoggle">Show / Hide Table of Contents</a>
          <div class="sidetoggle collapse" id="sidetoggle">
            <div id="sidetoc"></div>
          </div>
        </div>
        <div class="article row grid-right">
          <div class="col-md-10">
            <article class="content wrap" id="_content" data-uid="">
<h1 id="x-road-type-providers-in-c-projects">X-Road Type Providers in C# Projects</h1>

<p>Although Type Providers are very F# specific feature, it is possible, with a small amount of work,
to use X-Road provider goodness in C# projects too. This article describes neccessary steps to make
X-Road providers functionality available to C# projects.</p>
<h2 id="separate-f-project-for-x-road-dependencies">Separate F# Project for X-Road Dependencies</h2>
<p>Type providers are F# language specific feature, so we cannot do it without a F# project. But since
the setup is very minimal, you do not need to be familiar with F# programming language to get started.
You can relate to this project as a specific DSL for X-Road service interface generation.</p>
<p>Using Visual Studio, add new F# library project to your solution. Add dependency to
<a href="https://www.nuget.org/packages/XRoadProvider/">XRoadProvider NuGet package</a>. Remove all placeholder
code, that was generated by the template (there should not be too much). Add new F# source file
<code>Producers.fs</code> (or whatever name suits you best). Write following initialization code, which generates
the service interfaces:</p>
<pre><code class="lang-fsharp">namespace MyProject.Externals

open XRoad.Providers

let [&lt;Literal&gt;] WsdlLocalFile = __SOURCE_DIRECTORY__ + &quot;/path/to/file.wsdl&quot;

type SomeSystem = XRoadProducer&lt;WsdlLocalFile&gt;
</code></pre><p>Given that your WSDL file is correct and uses features that <code>XRoadProvider</code> understands, the project
should be ready to compile. Also you can reference it from your C# project and use the type <code>SomeSystem</code>
and its children to access provided X-Road services.</p>
<h2 id="tips-and-tricks">Tips and Tricks</h2>
<ul>
<li><p>WSDL files can be big and you may have a lot of different external dependencies. That makes compilation
of external dependencies F# project possibly very time consuming. Since WSDL should change quite rarely
in production, then there is usually no need for recompilation of the project every time.</p>
<p>Instead, it is recommended to exclude this project from solutions compilation under <em>Configuration Management</em>
and recompile the project manually when there is really a need for it (new dependencies or changes
in WSDL files).</p>
<p>Also, you should track the project output assemblies in source code repository, so that every developer
should not have to compile their own version the library.</p>
</li>
<li><p>When versioning the project assemblies we are only interested in the project own output not its dependencies.
The dependencies are usually not needed, because referencing projects have to define their own dependencies
to same packages, if they need to use them.</p>
<p>That allows us to keep F# project output folder clean, by making all NuGet dependencies not private.
Modify your F# project file, so that its dependencies are not copied to output directory. If you do
it manually, you have to change your project file dependencies to non-private.</p>
<pre><code class="lang-xml">&lt;Reference Include=&quot;FSharp.Core&quot;&gt;
  &lt;HintPath&gt;..\..\packages\FSharp.Core\lib\net45\FSharp.Core.dll&lt;/HintPath&gt;
  &lt;Private&gt;False&lt;/Private&gt;
&lt;/Reference&gt;
&lt;Reference Include=&quot;System.ValueTuple&quot;&gt;
  &lt;HintPath&gt;..\..\packages\System.ValueTuple\lib\net461\System.ValueTuple.dll&lt;/HintPath&gt;
  &lt;Private&gt;False&lt;/Private&gt;
&lt;/Reference&gt;
&lt;Reference Include=&quot;XRoadProvider&quot;&gt;
  &lt;HintPath&gt;..\..\packages\XRoadProvider\lib\net461\XRoadProvider.dll&lt;/HintPath&gt;
  &lt;Private&gt;False&lt;/Private&gt;
&lt;/Reference&gt;
</code></pre><p>In <em>MSBuild 15</em> style project files, the same behavior can be achieved by using following property value:</p>
<pre><code class="lang-xml">&lt;PropertyGroup&gt;
  &lt;CopyLocalLockFileAssemblies&gt;false&lt;/CopyLocalLockFileAssemblies&gt;
&lt;/PropertyGroup&gt;
</code></pre></li>
<li><p>Since type provider produces a static root type and nests all neccessary types under it in hierarchy,
the fully qualified name of the type can be very long, and usage of the types becomes hard.</p>
<p>This can be handled by using C# feature called <em>static using</em> which allows to import subtypes of
static type into current namespace without requiring full qualification of parent types:</p>
<pre><code class="lang-csharp">using static MyProject.Externals.Producers.SomeSystem.DefinedTypes.SomeXRoadEu;
using static MyProject.Externals.Producers.SomeSystem.DefinedTypes.SomeXRoadEu.SomeServiceRequestType;
using static MyProject.Externals.Producers.SomeSystem.portService;
</code></pre></li>
</ul>
</article>
          </div>
          
          <div class="hidden-sm col-md-2" role="complementary">
            <div class="sideaffix">
              <div class="contribution">
                <ul class="nav">
                  <li>
                    <a href="https://github.com/janno-p/XRoadProvider/blob/master/docs/articles/guide/xroad-provider-in-csharp.md/#L1" class="contribution-link">Improve this Doc</a>
                  </li>
                </ul>
              </div>
              <nav class="bs-docs-sidebar hidden-print hidden-xs hidden-sm affix" id="affix">
              <!-- <p><a class="back-to-top" href="#top">Back to top</a><p> -->
              </nav>
            </div>
          </div>
        </div>
      </div>
      
      <footer>
        <div class="grad-bottom"></div>
        <div class="footer">
          <div class="container">
            <span class="pull-right">
              <a href="#top">Back to top</a>
            </span>
            
            <span>Generated by <strong>DocFX</strong></span>
          </div>
        </div>
      </footer>
    </div>
    
    <script type="text/javascript" src="../../styles/docfx.vendor.js"></script>
    <script type="text/javascript" src="../../styles/docfx.js"></script>
    <script type="text/javascript" src="../../styles/main.js"></script>
  </body>
</html>
